openapi: 3.0.3
info:
  title: Tala Paints Platform API
  description: |
    Complete API documentation for Tala Paints e-commerce platform.
  version: 1.0.0
  contact:
    name: API Support
    email: support@talapaints.com
servers:
  - url: 'http://localhost:3000'
    description: Local development server
  - url: 'https://talas-paints.onrender.com'
    description: Production server
tags:
  - name: Health Check
    description: Server health monitoring
  - name: Products
    description: 'Product management operations (CRUD, search, filter)'
  - name: Categories
    description: Category management operations (CRUD)
  - name: Cart
    description: Shopping cart operations
  - name: Offers
    description: Product offers and discounts management
  - name: Ads Cards
    description: Advertisement card management operations (CRUD)
paths:
  /api/health:
    get:
      tags:
        - Health Check
      summary: Health check endpoint
      description: Check if the API server is running and healthy
      operationId: checkHealth
      responses:
        '200':
          description: Server is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: OK
                  timestamp:
                    type: string
                    format: date-time
                    example: '2025-06-22T18:46:00Z'
                  uptime:
                    type: number
                    description: Server uptime in seconds
                    example: 3600.5
  /api/products:
    post:
      tags:
        - Products
      summary: Create a new product
      description: Create a new product with optional image uploads.
      operationId: createProduct
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - name
                - description
                - category
                - sizes
                - status
              properties:
                name:
                  type: string
                  minLength: 2
                  maxLength: 255
                  example: Premium Interior Paint
                description:
                  type: string
                  minLength: 10
                  example: High-quality latex paint perfect for interior walls and ceilings
                category:
                  type: string
                  description: Category name (not category_id)
                  example: Interior Paints
                colors:
                  type: array
                  items:
                    type: string
                  description: Array of color names (optional)
                  example:
                    - Red
                    - Blue
                    - Green
                sizes:
                  type: array
                  items:
                    type: object
                    required:
                      - size
                      - price
                    properties:
                      size:
                        type: string
                        example: 1L
                      price:
                        type: number
                        format: float
                        example: 34.99
                  description: Array of available sizes and prices
                  example:
                    - size: 1L
                      price: 34.99
                    - size: 5L
                      price: 149.99
                status:
                  type: string
                  enum:
                    - visible
                    - hidden
                  description: Product visibility status
                  example: visible
                images:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: 'Product images (JPEG, PNG, or WebP, max 10 files, 5MB each)'
                  maxItems: 10
      responses:
        '201':
          description: Product created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Product'
                  message:
                    type: string
                    example: Product created successfully
        '400':
          description: Validation error or product already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                validationError:
                  value:
                    success: false
                    errors:
                      - msg: Name is required and must be a string
                        param: name
                        location: body
                duplicateProduct:
                  value:
                    success: false
                    message: Product already exists
    get:
      tags:
        - Products
      summary: Get all products with pagination
      description: Retrieve a list of all products ordered by creation date (newest first). Supports pagination when page and/or limit parameters are provided.
      operationId: getAllProducts
      parameters:
        - name: page
          in: query
          required: false
          description: Page number for pagination (starts from 1)
          schema:
            type: integer
            minimum: 1
            example: 1
        - name: limit
          in: query
          required: false
          description: 'Number of products per page (1-100, default 10)'
          schema:
            type: integer
            minimum: 1
            maximum: 100
            example: 10
      responses:
        '200':
          description: Products retrieved successfully
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Product'
                      count:
                        type: integer
                        description: Total number of products returned
                        example: 5
                    required:
                      - success
                      - data
                      - count
                  - type: object
                    properties:
                      success:
                        type: boolean
                        example: true
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Product'
                      pagination:
                        type: object
                        properties:
                          page:
                            type: integer
                            description: Current page number
                            example: 1
                          limit:
                            type: integer
                            description: Items per page
                            example: 10
                          total:
                            type: integer
                            description: Total number of products
                            example: 25
                          totalPages:
                            type: integer
                            description: Total number of pages
                            example: 3
                          hasNextPage:
                            type: boolean
                            description: Whether there is a next page
                            example: true
                          hasPrevPage:
                            type: boolean
                            description: Whether there is a previous page
                            example: false
                        required:
                          - page
                          - limit
                          - total
                          - totalPages
                          - hasNextPage
                          - hasPrevPage
                    required:
                      - success
                      - data
                      - pagination
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/products/all:
    get:
      tags:
        - Products
      summary: Get all products (without pagination)
      description: Retrieve a complete list of all products ordered by creation date (newest first). This endpoint returns all products in a single response without pagination.
      operationId: getAllProductsWithoutPagination
      responses:
        '200':
          description: All products retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Product'
                  count:
                    type: integer
                    description: Total number of products
                    example: 150
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  '/api/products/{id}':
    get:
      tags:
        - Products
      summary: Get product by ID
      description: Retrieve a single product by unique identifier
      operationId: getProductById
      parameters:
        - name: id
          in: path
          required: true
          description: Product UUID
          schema:
            type: string
            format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
      responses:
        '200':
          description: Product retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Product'
        '400':
          description: Invalid product ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Product not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Product not found
    put:
      tags:
        - Products
      summary: Update product
      description: Update an existing product. All fields optional.
      operationId: updateProduct
      parameters:
        - name: id
          in: path
          required: true
          description: Product UUID
          schema:
            type: string
            format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
      requestBody:
        required: false
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: Updated Premium Paint
                description:
                  type: string
                  example: Updated description with new features
                category:
                  type: string
                  description: Category name (not category_id)
                  example: Interior Paints
                colors:
                  type: array
                  items:
                    type: string
                  example:
                    - Red
                    - Blue
                    - Green
                    - Yellow
                sizes:
                  type: array
                  items:
                    type: object
                    properties:
                      size:
                        type: string
                        example: 1L
                      price:
                        type: number
                        format: float
                        example: 34.99
                  example:
                    - size: 1L
                      price: 34.99
                    - size: 5L
                      price: 149.99
                status:
                  type: string
                  enum:
                    - visible
                    - hidden
                  example: visible
                images:
                  type: array
                  items:
                    type: string
                    format: binary
                  maxItems: 10
                keepExistingImages:
                  type: string
                  enum:
                    - 'true'
                    - 'false'
                  description: Whether to keep existing images when uploading new ones
                  example: 'true'
      responses:
        '200':
          description: Product updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Product'
                  message:
                    type: string
                    example: Product updated successfully
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Product not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Product not found
    delete:
      tags:
        - Products
      summary: Delete product
      description: Delete a product and its associated images from AWS S3
      operationId: deleteProduct
      parameters:
        - name: id
          in: path
          required: true
          description: Product UUID
          schema:
            type: string
            format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
      responses:
        '200':
          description: Product deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Product deleted successfully
        '400':
          description: Invalid product ID or deletion failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Product not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Product not found
  /api/products/search:
    get:
      tags:
        - Products
      summary: Search products by name
      description: Search for products by name (partial matching)
      operationId: searchProducts
      parameters:
        - name: name
          in: query
          required: true
          description: Search term for product name
          schema:
            type: string
          example: paint
      responses:
        '200':
          description: Products found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Product'
                  count:
                    type: integer
                    description: Number of products found
                    example: 3
        '400':
          description: Missing search term
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/products/filter:
    get:
      tags:
        - Products
      summary: Filter products
      description: Filter by categories and/or price range (filters products where at least one size price is within the range)
      operationId: filterProducts
      parameters:
        - name: categories
          in: query
          schema:
            type: array
            items:
              type: string
              format: uuid
          required: false
          style: form
          explode: true
          example:
            - 650e8400-e29b-41d4-a716-446655440001
          description: Array of category IDs to filter by
        - name: minPrice
          in: query
          schema:
            type: number
            format: float
          required: false
          example: 10
          description: Minimum price filter (matches products with at least one size price >= minPrice)
        - name: maxPrice
          in: query
          schema:
            type: number
            format: float
          required: false
          example: 100
          description: Maximum price filter (matches products with at least one size price <= maxPrice)
      responses:
        '200':
          description: Filtered products retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Product'
                  count:
                    type: integer
                    example: 7
        '400':
          description: Invalid filter parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/categories:
    post:
      tags:
        - Categories
      summary: Create a new category
      description: 'Create a category with an image upload (single image). Image is stored in S3 under `categories/{categoryId}/...`.'
      operationId: createCategory
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - name
                - image
              properties:
                name:
                  type: string
                  minLength: 2
                  maxLength: 100
                  example: Interior Paint
                image:
                  type: string
                  format: binary
                  description: 'Category image (JPEG/PNG/WebP, max 5 MB)'
      responses:
        '201':
          description: Category created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    required:
                      - id
                      - name
                      - createdAt
                      - updatedAt
                    properties:
                      id:
                        type: string
                        format: uuid
                        example: 550e8400-e29b-41d4-a716-446655440000
                      name:
                        type: string
                        example: Interior Paint
                      images:
                        type: array
                        items:
                          type: string
                          format: uri
                        description: Category image URLs (normally a single element)
                        example:
                          - 'https://bucket.s3.us-east-1.amazonaws.com/categories/550e8400.../uuid.jpg'
                      createdAt:
                        type: string
                        format: date-time
                        example: '2025-11-25T09:00:00.000Z'
                      updatedAt:
                        type: string
                        format: date-time
                        example: '2025-11-25T09:15:00.000Z'
                  message:
                    type: string
                    example: Category created successfully
        '400':
          description: Validation error or malformed request
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1categories/get/responses/500/content/application~1json/schema'
    get:
      tags:
        - Categories
      summary: Get all categories
      operationId: getAllCategories
      responses:
        '200':
          description: Categories retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/paths/~1api~1categories/post/responses/201/content/application~1json/schema/properties/data'
                  count:
                    type: integer
                    example: 12
        '500':
          description: Unexpected server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: An error occurred
                  errors:
                    type: array
                    description: Detailed validation errors (if applicable)
                    items:
                      type: object
                      properties:
                        msg:
                          type: string
                          example: Name is required and must be a string
                        param:
                          type: string
                          example: name
                        location:
                          type: string
                          example: body
  '/api/categories/{id}':
    get:
      tags:
        - Categories
      summary: Get category by ID
      operationId: getCategoryById
      parameters:
        - name: id
          in: path
          required: true
          description: Category UUID
          schema:
            type: string
            format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
      responses:
        '200':
          description: Category retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/paths/~1api~1categories/post/responses/201/content/application~1json/schema/properties/data'
        '404':
          description: Resource not found
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1categories/get/responses/500/content/application~1json/schema'
    put:
      tags:
        - Categories
      summary: Update category
      description: Update category name and/or replace its image. Set `keepExistingImage` to `true` to retain the current image.
      operationId: updateCategory
      parameters:
        - name: id
          in: path
          required: true
          description: Category UUID
          schema:
            type: string
            format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                name:
                  type: string
                  minLength: 2
                  maxLength: 100
                  example: Exterior Paint
                image:
                  type: string
                  format: binary
                  description: New category image
                keepExistingImage:
                  type: string
                  enum:
                    - 'true'
                    - 'false'
                  description: Keep the current image (default false)
                  example: 'true'
      responses:
        '200':
          description: Category updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/paths/~1api~1categories/post/responses/201/content/application~1json/schema/properties/data'
                  message:
                    type: string
                    example: Category updated successfully
        '400':
          $ref: '#/paths/~1api~1categories/post/responses/400'
        '404':
          $ref: '#/paths/~1api~1categories~1%7Bid%7D/get/responses/404'
    delete:
      tags:
        - Categories
      summary: Delete category
      operationId: deleteCategory
      parameters:
        - name: id
          in: path
          required: true
          description: Category UUID
          schema:
            type: string
            format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
      responses:
        '200':
          description: Category deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Category deleted successfully
        '400':
          $ref: '#/paths/~1api~1categories/post/responses/400'
        '404':
          $ref: '#/paths/~1api~1categories~1%7Bid%7D/get/responses/404'
  '/api/cart/{phoneNumber}':
    get:
      tags:
        - Cart
      summary: Get user's cart
      description: Retrieve the user's shopping cart by phone number
      operationId: getCart
      parameters:
        - name: phoneNumber
          in: path
          required: true
          description: User's phone number
          schema:
            type: string
          example: '+1234567890'
      responses:
        '200':
          description: Cart retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/CartWithItems'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    description: Error message
                    example: An error occurred
    delete:
      tags:
        - Cart
      summary: Clear cart
      description: Remove all items from the user's cart
      operationId: clearCart
      parameters:
        - name: phoneNumber
          in: path
          required: true
          description: User's phone number
          schema:
            type: string
          example: '+1234567890'
      responses:
        '200':
          description: Cart cleared successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Cart cleared successfully
        '400':
          description: Error clearing cart
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1cart~1%7BphoneNumber%7D/get/responses/500/content/application~1json/schema'
  '/api/cart/{phoneNumber}/items':
    post:
      tags:
        - Cart
      summary: Add item to cart
      description: 'Add a product to the cart. If product exists, quantity is updated.'
      operationId: addToCart
      parameters:
        - name: phoneNumber
          in: path
          required: true
          description: User's phone number
          schema:
            type: string
          example: '+1234567890'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - productId
                - quantity
              properties:
                productId:
                  type: string
                  format: uuid
                  description: Product UUID to add to cart
                  example: 550e8400-e29b-41d4-a716-446655440000
                quantity:
                  type: integer
                  minimum: 1
                  description: Quantity to add
                  example: 2
      responses:
        '201':
          description: Product added to cart successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/CartItem'
                  message:
                    type: string
                    example: Product added to cart successfully
        '400':
          description: Validation error or insufficient stock
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1cart~1%7BphoneNumber%7D/get/responses/500/content/application~1json/schema'
  '/api/cart/{phoneNumber}/items/{cartItemId}':
    put:
      tags:
        - Cart
      summary: Update cart item quantity
      description: Update the quantity of a specific item in the cart
      operationId: updateCartItem
      parameters:
        - name: phoneNumber
          in: path
          required: true
          description: User's phone number
          schema:
            type: string
          example: '+1234567890'
        - name: cartItemId
          in: path
          required: true
          description: Cart item UUID
          schema:
            type: string
            format: uuid
          example: item-550e8400-e29b-41d4-a716-446655440000
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - quantity
              properties:
                quantity:
                  type: integer
                  minimum: 1
                  description: New quantity for the cart item
                  example: 3
      responses:
        '200':
          description: Cart item updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/CartItem'
                  message:
                    type: string
                    example: Cart item updated successfully
        '400':
          description: Validation error or insufficient stock
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1cart~1%7BphoneNumber%7D/get/responses/500/content/application~1json/schema'
        '404':
          description: Cart item not found
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1cart~1%7BphoneNumber%7D/get/responses/500/content/application~1json/schema'
    delete:
      tags:
        - Cart
      summary: Remove item from cart
      description: Remove a specific item from the user's cart
      operationId: removeFromCart
      parameters:
        - name: phoneNumber
          in: path
          required: true
          description: User's phone number
          schema:
            type: string
          example: '+1234567890'
        - name: cartItemId
          in: path
          required: true
          description: Cart item UUID
          schema:
            type: string
            format: uuid
          example: item-550e8400-e29b-41d4-a716-446655440000
      responses:
        '200':
          description: Item removed from cart successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Item removed from cart successfully
        '400':
          description: Error removing item
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1cart~1%7BphoneNumber%7D/get/responses/500/content/application~1json/schema'
        '404':
          description: Cart item not found
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1cart~1%7BphoneNumber%7D/get/responses/500/content/application~1json/schema'
  /api/offers:
    post:
      tags:
        - Offers
      summary: Create a new offer
      description: Create a new promotional offer (Percentage Discount or Buy 2 Get 1 Free)
      operationId: createOffer
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/CreateOfferRequest'
      responses:
        '201':
          description: Offer created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Offer'
                  message:
                    type: string
                    example: Offer created successfully
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                  errors:
                    type: array
                    items:
                      type: object
    get:
      tags:
        - Offers
      summary: Get all offers
      description: Retrieve a list of all offers
      operationId: getAllOffers
      responses:
        '200':
          description: Offers retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Offer'
                  count:
                    type: integer
                    example: 5
  '/api/offers/{id}':
    get:
      tags:
        - Offers
      summary: Get offer by ID
      description: Retrieve a specific offer by its ID
      operationId: getOfferById
      parameters:
        - name: id
          in: path
          required: true
          description: Offer UUID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Offer retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Offer'
        '404':
          description: Offer not found
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1offers/post/responses/400/content/application~1json/schema'
    put:
      tags:
        - Offers
      summary: Update offer
      description: Update an existing offer
      operationId: updateOffer
      parameters:
        - name: id
          in: path
          required: true
          description: Offer UUID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/UpdateOfferRequest'
      responses:
        '200':
          description: Offer updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Offer'
                  message:
                    type: string
                    example: Offer updated successfully
        '404':
          description: Offer not found
    delete:
      tags:
        - Offers
      summary: Delete offer
      description: Delete an offer by its ID
      operationId: deleteOffer
      parameters:
        - name: id
          in: path
          required: true
          description: Offer UUID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Offer deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Offer deleted successfully
        '404':
          description: Offer not found
  /api/ads-cards:
    post:
      tags:
        - Ads Cards
      summary: Create a new ads card
      description: 'Create a new advertisement card with title, text, and image upload.'
      operationId: createAdsCard
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - title
                - text
                - image
              properties:
                title:
                  type: string
                  minLength: 2
                  maxLength: 255
                  example: Special Paint Offer
                text:
                  type: string
                  minLength: 10
                  maxLength: 1000
                  example: Get 20% off on all interior paints this weekend! High-quality latex paint perfect for your home.
                image:
                  type: string
                  format: binary
                  description: 'Ads card image (JPEG, PNG, or WebP, max 5MB)'
                status:
                  $ref: '#/components/schemas/AdsCardStatus'
      responses:
        '201':
          description: Ads card created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/AdsCard'
                  message:
                    type: string
                    example: Ads card created successfully
        '400':
          description: Validation error or creation failed
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1ads-cards/get/responses/500/content/application~1json/schema'
    get:
      tags:
        - Ads Cards
      summary: Get all ads cards
      description: Retrieve a list of all ads cards ordered by creation date (newest first)
      operationId: getAllAdsCards
      responses:
        '200':
          description: Ads cards retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/AdsCard'
                  count:
                    type: integer
                    description: Total number of ads cards
                    example: 5
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    description: Error message
                    example: An error occurred
                  errors:
                    type: array
                    description: Detailed validation errors (if applicable)
                    items:
                      type: object
                      properties:
                        msg:
                          type: string
                          description: Error message
                          example: Title is required and must be a string
                        param:
                          type: string
                          description: Parameter that caused the error
                          example: title
                        location:
                          type: string
                          description: Location of the parameter
                          example: body
  /api/ads-cards/active:
    get:
      tags:
        - Ads Cards
      summary: Get active ads cards
      description: Retrieve a list of all active ads cards ordered by creation date (newest first)
      operationId: getActiveAdsCards
      responses:
        '200':
          description: Active ads cards retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/AdsCard'
                  count:
                    type: integer
                    description: Number of active ads cards
                    example: 3
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1ads-cards/get/responses/500/content/application~1json/schema'
  '/api/ads-cards/{id}':
    get:
      tags:
        - Ads Cards
      summary: Get ads card by ID
      description: Retrieve a single ads card by unique identifier
      operationId: getAdsCardById
      parameters:
        - name: id
          in: path
          required: true
          description: Ads card UUID
          schema:
            type: string
            format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
      responses:
        '200':
          description: Ads card retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/AdsCard'
        '400':
          description: Invalid ads card ID format
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1ads-cards/get/responses/500/content/application~1json/schema'
        '404':
          description: Ads card not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Ads card not found
    put:
      tags:
        - Ads Cards
      summary: Update ads card
      description: Update an existing ads card. All fields optional.
      operationId: updateAdsCard
      parameters:
        - name: id
          in: path
          required: true
          description: Ads card UUID
          schema:
            type: string
            format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
      requestBody:
        required: false
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                title:
                  type: string
                  minLength: 2
                  maxLength: 255
                  example: Updated Special Paint Offer
                text:
                  type: string
                  minLength: 10
                  maxLength: 1000
                  example: 'Updated offer: Get 25% off on all interior paints this weekend!'
                image:
                  type: string
                  format: binary
                  description: 'New ads card image (JPEG, PNG, or WebP, max 5MB)'
                status:
                  $ref: '#/components/schemas/AdsCardStatus'
                keepExistingImage:
                  type: string
                  enum:
                    - 'true'
                    - 'false'
                  description: Keep the current image (default false)
                  example: 'true'
      responses:
        '200':
          description: Ads card updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/AdsCard'
                  message:
                    type: string
                    example: Ads card updated successfully
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1ads-cards/get/responses/500/content/application~1json/schema'
        '404':
          description: Ads card not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Ads card not found
    delete:
      tags:
        - Ads Cards
      summary: Delete ads card
      description: Delete an ads card by its ID
      operationId: deleteAdsCard
      parameters:
        - name: id
          in: path
          required: true
          description: Ads card UUID
          schema:
            type: string
            format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
      responses:
        '200':
          description: Ads card deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Ads card deleted successfully
        '400':
          description: Invalid ads card ID or deletion failed
          content:
            application/json:
              schema:
                $ref: '#/paths/~1api~1ads-cards/get/responses/500/content/application~1json/schema'
        '404':
          description: Ads card not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Ads card not found
components:
  schemas:
    Product:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique product identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        name:
          type: string
          description: Product name
          example: Premium Interior Paint
        description:
          type: string
          description: Product description
          example: High-quality latex paint perfect for interior walls and ceilings
        category_id:
          type: string
          format: uuid
          description: Product category ID
          example: 650e8400-e29b-41d4-a716-446655440001
        colors:
          type: array
          items:
            type: string
          description: Available color options (optional)
          example:
            - Red
            - Blue
            - Green
        sizes:
          type: array
          items:
            type: object
            properties:
              size:
                type: string
                example: 1L
              price:
                type: number
                format: float
                example: 29.99
          description: Array of size objects
          example:
            - size: 1L
              price: 29.99
            - size: 5L
              price: 129.99
            - size: 10L
              price: 239.99
        status:
          type: string
          enum:
            - visible
            - hidden
          description: Product visibility status
          example: visible
        images:
          type: array
          items:
            type: string
            format: uri
          description: Array of image URLs stored in AWS S3
          example:
            - 'https://bucket.s3.us-east-1.amazonaws.com/products/550e8400.../uuid1.jpg'
            - 'https://bucket.s3.us-east-1.amazonaws.com/products/550e8400.../uuid2.jpg'
        createdAt:
          type: string
          format: date-time
          description: Product creation timestamp
          example: '2025-11-25T10:00:00.000Z'
        updatedAt:
          type: string
          format: date-time
          description: Product last update timestamp
          example: '2025-11-25T10:30:00.000Z'
      required:
        - id
        - name
        - description
        - category_id
        - sizes
        - status
        - createdAt
        - updatedAt
    Cart:
      type: object
      properties:
        phone_number:
          type: string
          description: User's phone number
          example: '+1234567890'
        totalAmount:
          type: number
          format: float
          description: Total amount of all items in the cart
          example: 91.98
      required:
        - phone_number
        - totalAmount
    CartItem:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique cart item identifier
          example: item-550e8400-e29b-41d4-a716-446655440000
        phone_number:
          type: string
          description: User's phone number
          example: '+1234567890'
        product_id:
          type: string
          format: uuid
          description: Product identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        quantity:
          type: integer
          minimum: 1
          description: Quantity of the product in cart
          example: 2
        price:
          type: number
          format: float
          description: Price snapshot at time of adding to cart
          example: 45.99
        createdAt:
          type: string
          format: date-time
          description: Cart item creation timestamp
          example: '2025-11-29T10:00:00.000Z'
        updatedAt:
          type: string
          format: date-time
          description: Cart item last update timestamp
          example: '2025-11-29T10:30:00.000Z'
      required:
        - id
        - phone_number
        - product_id
        - quantity
        - price
        - createdAt
        - updatedAt
    CartWithItems:
      allOf:
        - $ref: '#/components/schemas/Cart'
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/CartItem'
              description: List of items in the cart
          required:
            - items
    Offer:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        type:
          $ref: '#/components/schemas/OfferType'
        product_id:
          type: string
          format: uuid
        discount_percentage:
          type: number
          nullable: true
          minimum: 0
          maximum: 100
        buy_quantity:
          type: integer
          nullable: true
          minimum: 1
        get_quantity:
          type: integer
          nullable: true
          minimum: 1
        status:
          $ref: '#/components/schemas/OfferStatus'
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    OfferType:
      type: string
      enum:
        - PERCENTAGE_DISCOUNT
        - BUY_X_GET_Y_FREE
      description: Type of the offer
    OfferStatus:
      type: string
      enum:
        - VISIBLE
        - HIDDEN
      description: 'Offer visibility status (VISIBLE = shown & applied, HIDDEN = not shown / not applied)'
    OfferCalculationResult:
      type: object
      properties:
        original_price:
          type: number
        discount_amount:
          type: number
        final_price:
          type: number
        offer_applied:
          type: boolean
        offer_details:
          type: object
          properties:
            offer_id:
              type: string
              format: uuid
            offer_name:
              type: string
            offer_type:
              $ref: '#/components/schemas/OfferType'
    CreateOfferRequest:
      type: object
      required:
        - name
        - description
        - type
        - product_id
        - status
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 255
        description:
          type: string
        type:
          $ref: '#/components/schemas/OfferType'
        product_id:
          type: string
          format: uuid
        discount_percentage:
          type: number
          minimum: 0.01
          maximum: 100
          description: Required if type is PERCENTAGE_DISCOUNT
        buy_quantity:
          type: integer
          minimum: 1
          description: Required if type is BUY_X_GET_Y_FREE
        get_quantity:
          type: integer
          minimum: 1
          description: Required if type is BUY_X_GET_Y_FREE
        status:
          $ref: '#/components/schemas/OfferStatus'
    UpdateOfferRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 255
        description:
          type: string
        type:
          $ref: '#/components/schemas/OfferType'
        product_id:
          type: string
          format: uuid
        discount_percentage:
          type: number
          minimum: 0.01
          maximum: 100
        buy_quantity:
          type: integer
          minimum: 1
        get_quantity:
          type: integer
          minimum: 1
        status:
          $ref: '#/components/schemas/OfferStatus'
    AdsCard:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique ads card identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        title:
          type: string
          description: Ads card title
          example: Special Paint Offer
        text:
          type: string
          description: Ads card description text
          example: Get 20% off on all interior paints this weekend! High-quality latex paint perfect for your home.
        imageUrl:
          type: string
          format: uri
          description: URL of the ads card image
          example: 'https://example.com/ads/special-offer.jpg'
        status:
          $ref: '#/components/schemas/AdsCardStatus'
        createdAt:
          type: string
          format: date-time
          description: Ads card creation timestamp
          example: '2025-11-25T10:00:00.000Z'
        updatedAt:
          type: string
          format: date-time
          description: Ads card last update timestamp
          example: '2025-11-25T10:30:00.000Z'
      required:
        - id
        - title
        - text
        - imageUrl
        - status
        - createdAt
        - updatedAt
    AdsCardStatus:
      type: string
      enum:
        - ACTIVE
        - INACTIVE
      description: Ads card status
      example: ACTIVE
    CreateAdsCardRequest:
      type: object
      required:
        - title
        - text
        - imageUrl
      properties:
        title:
          type: string
          minLength: 2
          maxLength: 255
          example: Special Paint Offer
        text:
          type: string
          minLength: 10
          maxLength: 1000
          example: Get 20% off on all interior paints this weekend! High-quality latex paint perfect for your home.
        imageUrl:
          type: string
          format: uri
          example: 'https://example.com/ads/special-offer.jpg'
        status:
          $ref: '#/components/schemas/AdsCardStatus'
    UpdateAdsCardRequest:
      type: object
      properties:
        title:
          type: string
          minLength: 2
          maxLength: 255
          example: Updated Special Paint Offer
        text:
          type: string
          minLength: 10
          maxLength: 1000
          example: 'Updated offer: Get 25% off on all interior paints this weekend!'
        imageUrl:
          type: string
          format: uri
          example: 'https://example.com/ads/updated-special-offer.jpg'
        status:
          $ref: '#/components/schemas/AdsCardStatus'
    Error:
      type: object
      properties:
        success:
          type: boolean
          example: false
        message:
          type: string
          description: Error message
          example: An error occurred
        errors:
          type: array
          description: Detailed validation errors (if applicable)
          items:
            type: object
            properties:
              msg:
                type: string
                description: Error message
                example: Name is required and must be a string
              param:
                type: string
                description: Parameter that caused the error
                example: name
              location:
                type: string
                description: Location of the parameter
                example: body
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authentication
