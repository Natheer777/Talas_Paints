openapi: 3.0.3
info:
  title: Tala Paints Platform API
  description: |
    Complete API documentation for Tala Paints e-commerce platform.
  version: 1.0.0
  contact:
    name: API Support
    email: support@talapaints.com

servers:
  - url: http://localhost:3000
    description: Local development server
  - url: https://talas-paints.onrender.com
    description: Production server

tags:
  - name: Health Check
    description: Server health monitoring
  - name: Products
    description: Product management operations (CRUD, search, filter)
  - name: Categories
    description: Category management operations (CRUD)
  - name: Orders
    description: Order management operations with real-time notifications
  - name: Offers
    description: Product offers and discounts management
  - name: Ads Cards
    description: Advertisement card management operations (CRUD)
  - name: Video Cards
    description: Video card management operations (CRUD)
  - name: Payment Methods
    description: Payment method management with QR code images

paths:
  # Health Check
  /api/health:
    $ref: "./swagger-products.yaml#/paths/~1health"

  # Products - CRUD
  /api/products:
    $ref: "./swagger-products.yaml#/paths/~1products"

  /api/products/all:
    $ref: "./swagger-products.yaml#/paths/~1products~1all"

  /api/products/{id}:
    $ref: "./swagger-products.yaml#/paths/~1products~1{id}"

  # Products - Search & Filter
  /api/products/search:
    $ref: "./swagger-products.yaml#/paths/~1products~1search"

  /api/products/filter:
    $ref: "./swagger-products.yaml#/paths/~1products~1filter"

  /api/products/active-offers:
    $ref: "./swagger-products.yaml#/paths/~1products~1active-offers"

  # Categories
  /api/categories:
    $ref: "./swagger-categories.yaml#/paths/~1categories"

  /api/categories/{id}:
    $ref: "./swagger-categories.yaml#/paths/~1categories~1{id}"

  # Order operations
  /api/orders:
    $ref: "./swagger-orders.yaml#/paths/~1orders"

  /api/orders/{orderId}:
    $ref: "./swagger-orders.yaml#/paths/~1orders~1{orderId}"

  /api/orders/{orderId}/status:
    $ref: "./swagger-orders.yaml#/paths/~1orders~1{orderId}~1status"

  /api/admin/orders:
    $ref: "./swagger-orders.yaml#/paths/~1admin~1orders"

  # Offers
  /api/offers:
    $ref: "./swagger-offers.yaml#/paths/~1offers"

  /api/offers/details:
    $ref: "./swagger-offers.yaml#/paths/~1offers~1details"

  /api/offers/{id}:
    $ref: "./swagger-offers.yaml#/paths/~1offers~1{id}"


  # Ads Cards
  /api/ads-cards:
    $ref: "./swagger-ads-card.yaml#/paths/~1ads-cards"

  /api/ads-cards/active:
    $ref: "./swagger-ads-card.yaml#/paths/~1ads-cards~1active"

  /api/ads-cards/{id}:
    $ref: "./swagger-ads-card.yaml#/paths/~1ads-cards~1{id}"

  # Video Cards
  /api/video-cards:
    $ref: "./swagger-video-card.yaml#/paths/~1video-cards"

  /api/video-cards/visible:
    $ref: "./swagger-video-card.yaml#/paths/~1video-cards~1visible"

  /api/video-cards/{id}:
    $ref: "./swagger-video-card.yaml#/paths/~1video-cards~1{id}"

  # Payment Methods
  /api/payment-methods:
    $ref: "./swagger-payment-methods.yaml#/paths/~1payment-methods"

  /api/payment-methods/visible:
    $ref: "./swagger-payment-methods.yaml#/paths/~1payment-methods~1visible"

  /api/payment-methods/{id}:
    $ref: "./swagger-payment-methods.yaml#/paths/~1payment-methods~1{id}"

components:
  schemas:
    # Product schemas
    Product:
      $ref: "./swagger-products.yaml#/components/schemas/Product"
    
    # Order schemas
    Order:
      $ref: "./swagger-orders.yaml#/components/schemas/Order"
    
    OrderItem:
      $ref: "./swagger-orders.yaml#/components/schemas/OrderItem"
    
    OrderStatus:
      $ref: "./swagger-orders.yaml#/components/schemas/OrderStatus"
    
    PaymentMethodType:
      $ref: "./swagger-orders.yaml#/components/schemas/PaymentMethodType"
    
    CreateOrderRequest:
      $ref: "./swagger-orders.yaml#/components/schemas/CreateOrderRequest"
    
    # Offer schemas
    Offer:
      $ref: "./swagger-offers.yaml#/components/schemas/Offer"
    
    OfferType:
      $ref: "./swagger-offers.yaml#/components/schemas/OfferType"
    
    OfferStatus:
      $ref: "./swagger-offers.yaml#/components/schemas/OfferStatus"
    
    OfferWithDetails:
      $ref: "./swagger-offers.yaml#/components/schemas/OfferWithDetails"

    OfferCalculationResult:
      $ref: "./swagger-offers.yaml#/components/schemas/OfferCalculationResult"

    CreateOfferRequest:
      $ref: "./swagger-offers.yaml#/components/schemas/CreateOfferRequest"

    UpdateOfferRequest:
      $ref: "./swagger-offers.yaml#/components/schemas/UpdateOfferRequest"

    # Category schema (referenced by OfferWithDetails)
    Category:
      $ref: "./swagger-offers.yaml#/components/schemas/Category"

    # Ads Card schemas
    AdsCard:
      $ref: "./swagger-ads-card.yaml#/components/schemas/AdsCard"

    AdsCardStatus:
      $ref: "./swagger-ads-card.yaml#/components/schemas/AdsCardStatus"

    CreateAdsCardRequest:
      $ref: "./swagger-ads-card.yaml#/components/schemas/CreateAdsCardRequest"

    UpdateAdsCardRequest:
      $ref: "./swagger-ads-card.yaml#/components/schemas/UpdateAdsCardRequest"

    # Video Card schemas
    VideoCard:
      $ref: "./swagger-video-card.yaml#/components/schemas/VideoCard"

    VideoStatus:
      $ref: "./swagger-video-card.yaml#/components/schemas/VideoStatus"

    CreateVideoCardRequest:
      $ref: "./swagger-video-card.yaml#/components/schemas/CreateVideoCardRequest"

    UpdateVideoCardRequest:
      $ref: "./swagger-video-card.yaml#/components/schemas/UpdateVideoCardRequest"

    # Payment Methods schemas
    PaymentMethod:
      $ref: "./swagger-payment-methods.yaml#/components/schemas/PaymentMethod"

    PaymentMethodStatus:
      $ref: "./swagger-payment-methods.yaml#/components/schemas/PaymentMethodStatus"

    # Common schemas
    Error:
      $ref: "./swagger-products.yaml#/components/schemas/Error"

    RateLimitError:
      type: object
      properties:
        success:
          type: boolean
          example: false
        message:
          type: string
          example: "Too many requests, please try again later."
        error:
          type: object
          properties:
            code:
              type: string
              example: "RATE_LIMIT_EXCEEDED"
            limit:
              type: integer
              example: 100
            remaining:
              type: integer
              example: 0
            resetTime:
              type: string
              format: date-time
              example: "2025-12-13T10:00:00.000Z"
            retryAfter:
              type: integer
              example: 30

  headers:
    RateLimitLimit:
      description: The maximum number of requests allowed in the current window
      schema:
        type: integer
    RateLimitRemaining:
      description: The number of requests remaining in the current window
      schema:
        type: integer
    RateLimitReset:
      description: The UTC date/time when the window resets
      schema:
        type: string
        format: date-time
    RetryAfter:
      description: The number of seconds to wait before retrying
      schema:
        type: integer

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authentication
    
    HmacSignature:
      type: apiKey
      in: header
      name: X-Signature
      description: |
        HMAC-SHA256 signature of the request.
        Format: Hex encoded string.
        Construction: `hmac_sha256(secret_key, url + body_json_string + timestamp)`
    
    HmacTimestamp:
      type: apiKey
      in: header
      name: X-Timestamp
      description: |
        Current Unix timestamp in milliseconds.
        Must be within 5 minutes of server time.

security:
  - HmacSignature: []
    HmacTimestamp: []

